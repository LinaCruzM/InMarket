<app-toolbar></app-toolbar><div class="container-box">
    <main class="table" id="customers_table">
      <section class="table-header">
          <h1>Roles</h1>
              <button  (click)="openModal()" class="add-btn"><i class="bi bi-plus-circle"></i>Agregar</button>
      </section>
      <section class="table-body">
          <table>
              <thead>
                <tr>
                    <th>Nombre del rol</th>
                    <th>Área</th>
                    <th></th>
                    <th></th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let rol of roles">
                    <td>{{ rol.rol_name }}</td>
                    <td>{{ rol.Area.are_name }}</td>
                    <td>
                      <button (click)="editRol(rol.rol_id)" class="edit-btn"><i class="bi bi-pencil-square"></i></button>
                    </td>
                    <td>
                      <button (click)="confirmDeleteRol(rol.rol_id)" class="delete-btn"><i class="bi bi-trash3-fill"></i></button>
                    </td>
                  </tr>
              </tbody>
          </table>
      </section>
  </main>
  </div>
  <!-- Modal para agregar/editar rol -->
<div class="modal" [ngClass]="{'show': showModal}" (click)="closeModal()">
  <div class="modal-content large" (click)="$event.stopPropagation()">
    <h2>{{ isEditMode ? 'Editar Rol' : 'Agregar Rol' }}</h2>
    <form #rolForm="ngForm" (ngSubmit)="onSubmitForm()">
      
      <div class="modal-div">
        <label for="rol_name">Nombre del rol:</label>
        <input type="text" id="rol_name" [(ngModel)]="currentRol.rol_name" name="rol_name" required>
      </div>
  
      <div class="modal-div">
        <label for="are_name">Área:</label>
        <select id="are_name" [(ngModel)]="currentRol.are_id" name="are_id" required>
          <option *ngFor="let area of areas" [value]="area.are_id">{{ area.are_name }}</option>
        </select>
      </div>
  
      <div class="modal-btn">
        <button class="btn" type="submit" [disabled]="rolForm.invalid">
          <i class="bi bi-plus-circle"></i>{{ isEditMode ? 'Actualizar' : 'Crear' }}
        </button>
        <button class="btn" (click)="closeModal()" type="button">
          <i class="bi bi-x-circle"></i>Cerrar
        </button>
      </div>
    </form>
  </div>
   
</div>

<!-- Modal para confirmación de eliminación -->
<div class="modal" [ngClass]="{'show': showDeleteModal}" (click)="closeDeleteModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <h2>Eliminar Rol</h2>
    <div class="modal-delete">
      <p>¿Estás seguro/a de que deseas eliminar este usuario? No podrás deshacer esta acción.</p>
      <div class="modal-btn">
        <button class="btn"  (click)="rolToDelete !== null && deleteRol(rolToDelete)"  type="button">Eliminar</button>
        <button class="btn" (click)="closeDeleteModal()"  type="button">Cancelar</button>
     </div>
    </div>
  </div>
</div>

